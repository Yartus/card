# WeCard 前端界面系统指南

> **版本**: v2.8  
> **更新**: 2025-11-14  
> **适用**: 企业微信工作台 + 多租户SaaS名片系统

---

## 📚 系统概述

### 核心架构
```
服务商（您）
  └── 租户（企业，通过企微扫码接入）
       └── 员工（企微用户，继承租户配置）
```

### 技术栈
- **前端**: Vue 2 + Nuxt.js + Vuex
- **UI**: 自研标准化组件系统
- **动画**: Lottie + CSS动画
- **运行**: 企业微信工作台 WebView

### 访问路径
- **生产**: https://zjemail.cn/wecom/workspace
- **目录**: /opt/qwcard

---

## 🏗️ 工作台架构

### 主界面结构
```
工作台 (workspace.vue)
├── 名片配置Tab
│   ├── 模块库（左）
│   ├── 配置区（中）
│   └── 预览面板（右）
├── 素材库Tab
│   ├── 素材列表
│   └── 富文本编辑器
└── 成员管理Tab (v2.8新增)
    ├── 成员列表表格
    └── 行内编辑功能
```

### 核心组件
| 组件 | 路径 | 职责 |
|------|------|------|
| workspace.vue | pages/wecom/ | 主控制器 |
| ConfigArea.vue | components/workspace/ | 配置管理 |
| PreviewPanel.vue | components/workspace/ | 实时预览 |
| ModuleLibrary.vue | components/workspace/ | 模块库 |
| AssetsLibrary.vue | components/workspace/ | 素材库管理 |
| AssetsCoverEditor.vue | components/workspace/ | 素材封面编辑 |
| AssetsContentEditor.vue | components/workspace/ | 素材内容编辑 |

---

## 🎨 名片模块系统

### 可用模块列表

| 模块 | 组件 | 配置组件 | 分类 |
|------|------|---------|------|
| 名片头部 | CardHeader.vue | BackgroundEditor.vue, AvatarEditor.vue | 基础 |
| 企业简介 | CompanyIntro.vue | CompanyIntroConfig.vue | 展示 |
| 通用网格 | StandardGrid.vue | StandardGridConfig.vue | 展示 |
| 多媒体展示 | VideoShowcase.vue | VideoShowcaseConfig.vue | 展示 |
| Logo墙 | LogoWall.vue | LogoWallConfig.vue | 展示 |
| 信任背书 | TrustCredentials.vue | TrustCredentialsConfig.vue | 展示 |
| 时间线 | Timeline.vue | TimelineConfig.vue | 展示 |
| 网店直达 | ShopDirect.vue | ShopDirectConfig.vue | 社交 |
| 推送消息配置 | - | PushConfigSection.vue | 系统 |
| 成员管理 (v2.8) | - | 成员列表表格 | 系统 |
| 联系方式配置 (v2.8) | ContactInfo.vue | ContactVisibilityConfig.vue | 基础 |

### 成员管理模块 (v2.8新增，v2024-11-18优化)

**功能入口**: 管理员工作台 → 👥 成员管理标签页

**表格结构**（8列紧凑设计）:
| 列名 | 宽度 | 说明 |
|------|------|------|
| 头像 | 70px | 显示企微头像或管理员自定义头像 |
| 推送照片 | 80px | 推送卡片展示图（60x60缩略图） |
| 员工姓名 | 160px | 真实姓名 + ID后6位 + 数据来源徽章 |
| 手机号码 | 130px | 联系电话 |
| 职位 | 110px | 职位名称 |
| 角色 | 80px | 管理员/员工 |
| 数据来源 | 90px | OAuth授权/通讯录（带状态徽章）|
| 操作 | 90px | 编辑/保存/取消按钮 |

**核心功能**:
- **姓名显示逻辑**：优先显示 `display_name` → `name`（若非加密ID）→ "未设置"
- **数据来源标识**：蓝色"OAuth"徽章 / 灰色"本地"徽章
- **行内编辑**：姓名、手机、职位、头像、推送照片
- **快速识别**：ID后6位 + 悬停显示完整ID

**使用场景**: 解决企微OAuth授权后姓名仍为加密ID的问题，管理员手动设置真实信息

### 联系方式配置模块 (v2.8增强)

**功能入口**: 管理员工作台 → 👁️ 联系方式标签

**核心功能**:
- **显示开关**: 控制手机、邮箱、微信、座机、地址、官网的显示/隐藏
- **企业信息编辑** (新增): 配置企业级联系信息（全员共享）
  - 公司座机、办公地址、公司官网

**组件**: `ContactVisibilityConfig.vue`

**配置存储**: `workspace.header.company_info`

**数据流向**: 管理员配置 → 后端API读取 → 所有员工名片显示

### 推送消息配置模块

**功能**：配置添加好友后自动推送的名片消息

**消息推送逻辑**：
1. 客户添加员工 → 自动发送两条消息：
   - 文字消息（cardTitle）
   - 卡片消息（链接到 `/card-preview/:tenantId/:memberId`）
2. 客户点击卡片 → 跳转完整名片页面

**核心配置项**：
- **消息标题**：第一条文字消息内容
- **头像模式**：公司统一图片 / 员工照片
- **背景类型**：图片 / 纯色
- **主题颜色**：统一设置底部区域、电话图标、头像边框
- **个人介绍**：可选，默认使用公司介绍

**推送头像优先级**：
1. 成员管理中的 `custom_push_photo_url`（单人设置）← 最高优先级
2. 推送配置中的 `companyAvatar`（全局统一）← 兜底配置
3. 企微头像（avatarMode=member时）

**设计理念**：
- **全局配置**：推送设置中的 `companyAvatar` 作为全租户统一推送图（如公司Logo）
- **单点覆盖**：成员管理中可为特定员工设置专属推送照片（如销售团队个人照）
- **应用场景**：品牌统一 vs 个性化展示的平衡

**存储位置**：`Tenant.config.push_config`

### 模块定义
**位置**: `/config/framework-definitions.js`

每个模块包含：
- `id`: 唯一标识
- `name`: 显示名称
- `component`: 展示组件路径
- `configComponent`: 配置组件路径
- `dataSchema`: 默认数据结构
- `planLimits`: 套餐限制

### 模块排序机制

**数据流**：
1. 配置工作台：拖拽排序 → 更新 `sort_order`
2. Vuex Store：`enabledModules` getter 按 `sort_order` 排序
3. 预览数据：`previewData` getter 转换为 `modules_list`（保持排序）
4. 展示组件：`WecardOptimized.vue` 使用 `sortedModulesList` 计算属性确保排序

**关键实现**：
- `store/workspace.js`: `enabledModules` getter 自动排序
- `components/WecardOptimized.vue`: `sortedModulesList` 计算属性二次排序确保正确
- 支持多个同类型模块：每个模块独立 `sort_order`，可创建多个同类型模块

### 网店直达模块

**功能**：展示企业网店链接，支持APP唤醒和微信小程序唤醒

**支持平台**：
- **电商平台（APP唤醒）**：天猫、京东、拼多多、1688、淘宝、自定义平台
- **微信生态（小程序唤醒）**：微信小程序、微信小店

**数据结构**：
```javascript
{
  title: '网店直达',
  subtitle: '点击进入我们的官方店铺',
  shops: [
    {
      id: 'shop-xxx',
      name: '天猫旗舰店',
      platform: 'tmall',  // 平台类型
      image: '/uploads/xxx.jpg',  // 横版展示图
      appScheme: 'tmall://shop?id=xxx',  // APP唤醒链接
      webUrl: 'https://xxx.tmall.com',  // H5备用链接
      enabled: true
    }
  ]
}
```

**套餐限制**：
- free/trial: 2个网店
- pro/enterprise: 3个网店

**唤醒逻辑**：
- 移动端：尝试APP唤醒 → 降级到H5链接
- 小程序：URL Scheme → 小程序链接 → 小程序码
- 工具函数：`utils/shop-handler.js` 统一处理

---

## 🎨 CSS 设计标准

### 1. 模块容器标准

```scss
// 所有模块统一样式
.module-container {
  margin: 12px 16px;              // 外边距
  background: #ffffff;             // 背景色
  border: 1px solid rgba(0,0,0,.08);  // 边框
  border-radius: 12px;             // 圆角
  box-shadow: 0 2px 8px rgba(0,0,0,.04);  // 阴影
  overflow: hidden;                // 防止子元素溢出
}
```

### 2. 标题区域标准

```scss
// 标题容器
.section-header {
  padding: 20px 20px 16px 20px;  // 内边距
  border-bottom: 1px solid #f0f2f5;  // 分割线
}

// 主标题
.section-title {
  font-size: 16px;                // 字号
  font-weight: 600;               // 字重
  color: #262626;                 // 颜色（深灰）
  margin: 0 0 6px 0;              // 间距
  line-height: 1.4;               // 行高
}

// 副标题
.section-subtitle {
  font-size: 14px;                // 字号
  color: #8c8c8c;                 // 颜色（中灰）
  margin: 0;
  line-height: 1.6;               // 行高
}
```

### 3. 内容区域标准

```scss
// 内容容器
.module-body {
  padding: 20px;                  // 统一内边距
}

// 内容文本（正文段落）
.content-text,
.text-paragraph {
  font-size: 14px;                // 正文字号
  color: #595959;                 // 正文颜色
  line-height: 1.8;               // 行高（易读性）
  margin: 0 0 12px 0;             // 段落间距12px
  
  &:last-child {
    margin-bottom: 0;             // 最后一段无下边距
  }
}

// 次要文本（说明文字）
.content-highlight,
.text-hint {
  font-size: 12px;
  color: #8c8c8c;
  line-height: 1.4;
}

// 事件描述（Timeline模块特殊格式）
.event-description {
  font-size: 13px;                // 略小于正文
  color: #595959;
  line-height: 1.4;               // 紧凑行高
  margin: 0;
}
```

### 4. 图片标准

```scss
// 图片容器
.image-wrapper {
  border-radius: 12px;            // 统一圆角12px
  overflow: hidden;
  box-shadow: 0 2px 12px rgba(0,0,0,.08);  // 阴影
}

// 图片本身（所有图片统一使用12px圆角）
.module-image,
.block-image,
.thumbnail-image,
.image-grid,
.cert-image img,
.carousel-image img,
.award-image img {
  width: 100%;
  height: auto;
  object-fit: cover;              // 裁剪方式（或contain）
  display: block;
  border-radius: 12px;            // ⚠️ 统一圆角：12px（必须）
  transition: transform 0.4s ease;  // 过渡动画
  
  &:hover {
    transform: scale(1.04);       // 悬停放大（1.04或1.05）
  }
}

// 顶部大图（企业简介/多媒体）
.image-top {
  width: 100%;
  padding: 20px 20px 0 20px;      // 呼吸感间距
  
  img {
    width: 100%;
    height: 240px;                // 固定高度
    object-fit: cover;
    border-radius: 12px;          // ⚠️ 统一圆角：12px
    box-shadow: 0 2px 12px rgba(0,0,0,.08);
  }
}

// 图片说明文字
.image-caption {
  font-size: 12px;                // 说明文字字号
  color: #8c8c8c;                 // 说明文字颜色
  line-height: 1.4;               // 说明文字行高
  margin: 12px 0 0 0;             // 图片与说明间距
  text-align: center;             // 居中显示
}
```

### 5. 网格布局标准

```scss
// 网格容器
.grid-container {
  display: grid;
  gap: 16px;                      // 网格间距
  
  &.grid-cols-1 { grid-template-columns: 1fr; }
  &.grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
  &.grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
}

// 网格项
.grid-item {
  border: 1px solid rgba(0,0,0,.06);
  border-radius: 12px;
  background: #ffffff;
  box-shadow: 0 2px 8px rgba(0,0,0,.04);
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-4px);   // 上浮效果
    box-shadow: 0 8px 24px rgba(0,0,0,.12);
  }
}
```

### 6. 颜色规范

```scss
// 主色调
$primary-color: #1890FF;          // 主题蓝
$success-color: #52C41A;          // 成功绿
$warning-color: #FAAD14;          // 警告橙
$error-color: #F5222D;            // 错误红

// 文字颜色
$text-primary: #262626;           // 主文字（深灰）
$text-secondary: #595959;         // 次要文字
$text-tertiary: #8c8c8c;          // 辅助文字（浅灰）
$text-disabled: #BFBFBF;          // 禁用文字

// 背景颜色
$bg-white: #FFFFFF;               // 白色背景
$bg-gray: #F5F5F5;                // 浅灰背景
$bg-divider: #F0F2F5;             // 分割线背景

// 边框颜色
$border-base: rgba(0,0,0,.08);    // 基础边框
$border-light: rgba(0,0,0,.06);   // 浅边框
$border-strong: rgba(0,0,0,.15);  // 强边框
```

### 7. 阴影规范

```scss
// 基础阴影（卡片）
box-shadow: 0 2px 8px rgba(0,0,0,.04);

// 悬停阴影
box-shadow: 0 8px 24px rgba(0,0,0,.12);

// 激活阴影
box-shadow: 0 4px 12px rgba(0,0,0,.10);

// 图片阴影
box-shadow: 0 2px 12px rgba(0,0,0,.08);
```

### 8. 圆角规范

```scss
// 模块容器/卡片
border-radius: 12px;              // 标准圆角

// ⚠️ 图片统一圆角（所有模块必须遵守）
// 包括：素材库图片、VideoShowcase图片、TrustCredentials图片等
border-radius: 12px;              // 图片圆角统一为12px

// 小型元素（按钮/标签）
border-radius: 6px;               // 小圆角

// 圆形（头像/图标）
border-radius: 50%;               // 完全圆形
```

### 9. 间距规范

```scss
// 外边距（模块间）
margin: 12px 16px;                // 上下12px，左右16px

// 内边距（容器）
padding: 20px;                    // 标准内边距

// 标题内边距
padding: 20px 20px 16px 20px;    // 上/左右/下

// 网格间距
gap: 16px;                        // 统一16px

// 文字间距
margin-bottom: 12px;              // 段落间距（正文段落之间）

// 内容块间距
gap: 16px;                         // 内容块之间间距（使用flex/grid时）
```

### 10. 过渡动画规范

```scss
// 标准过渡
transition: all 0.3s ease;

// 缓动函数（推荐）
transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

// 图片过渡
transition: transform 0.4s ease;

// 禁用动画（企微工作台）
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
    animation: none !important;
  }
}
```

---

## 📱 响应式设计

### 移动端适配

```scss
@media (max-width: 768px) {
  // 网格改为单列
  .grid-cols-2,
  .grid-cols-3 {
    grid-template-columns: 1fr !important;
  }
  
  // 减少内边距
  .module-body {
    padding: 16px;              // 20px → 16px
  }
  
  .section-header {
    padding: 16px 16px 12px 16px;
  }
  
  // 字号调整
  .section-title {
    font-size: 15px;            // 16px → 15px
  }
  
  .content-text,
  .text-paragraph {
    font-size: 13px;            // 14px → 13px
  }
  
  .section-subtitle {
    font-size: 13px;            // 14px → 13px
  }
  
  .image-caption {
    font-size: 12px;            // 保持12px
  }
}
```

---

## 🎨 图标系统

### 图标资源概览

| 类型 | 数量 | 存储位置 | 状态 |
|------|------|----------|------|
| **Emoji表情** | 131 | 内置代码 | ✅ 可用 |
| **CSS图标** | 21 | `/assets/css/icon-font.css` | ✅ 可用 |
| **SVG图标** | 131 | `/static/icons/` | ✅ 可用 |
| **Lottie动画** | 10+ | `/assets/animations/` | ✅ 可用 |
| **总计** | **300+** | - | ✅ 可用 |

### SVG图标分类（10大类）

| 分类 | 英文标识 | 数量 | 典型图标 |
|------|---------|------|---------|
| 📞 通用 | general | 15个 | 电话、邮箱、位置、传真 |
| 💼 业务 | business | 18个 | 办公、会议、报告、评价 |
| 💻 技术 | technology | 16个 | 代码、数据库、云服务 |
| 📱 社交 | social | 20个 | 微信、Facebook、Twitter |
| 🛒 电商 | ecommerce | 12个 | 购物车、支付、订单 |
| ➡️ 箭头 | arrows | 10个 | 上下左右各方向箭头 |
| 🎨 界面 | interface | 15个 | 菜单、设置、搜索 |
| 🎬 媒体 | media | 12个 | 视频、音乐、图片 |
| 💬 通信 | communication | 8个 | 消息、通知、对话 |
| 📄 文件 | files | 5个 | 文档、PDF、表格 |

### 图标配置文件

**位置**: `/config/icon-library.js`

**核心结构**:
```javascript
// SVG图标定义
export const SVG_ICONS = [
  { 
    name: '微信', 
    file: 'wechat.svg', 
    category: 'social',
    keywords: ['wechat', 'weixin', '社交']
  },
  // ... 共131个
]

// 分类定义
export const SVG_CATEGORIES = {
  all: '全部',
  general: '通用',
  business: '业务',
  technology: '技术',
  social: '社交',
  // ... 共10个分类
}

// CSS图标定义
export const CSS_ICONS = [
  { class: 'icon-phone', name: '电话', category: 'contact' },
  // ... 共21个
]

// Emoji图标定义
export const EMOJI_ICONS = [
  { emoji: '😀', name: '笑脸', category: 'faces' },
  // ... 共131个
]
```

### IconPicker 组件

**位置**: `/components/workspace/form/IconPicker.vue`

**核心功能**:
- ✅ 4种图标类型切换（Emoji/CSS/SVG/Lottie）
- ✅ SVG图标分类筛选（10个分类）
- ✅ 实时搜索功能（支持名称/关键词）
- ✅ 透明图标预览优化（棋盘格背景）
- ✅ 居中弹窗显示
- ✅ 响应式布局
- ✅ 类型自动同步（iconType）

**使用示例**:
```vue
<IconPicker
  v-model="item.icon"
  :type.sync="item.iconType"
  label="选择图标"
  placeholder="点击选择图标"
  @change="handleIconChange"
/>
```

**返回值**:
```javascript
// Emoji类型
{ icon: '😀', iconType: 'emoji' }

// CSS类型
{ icon: 'icon-phone', iconType: 'css' }

// SVG类型
{ icon: '/icons/wechat.svg', iconType: 'svg' }

// Lottie类型
{ icon: '/animations/loading.json', iconType: 'lottie' }
```

### 图标渲染（展示组件）

**在名片展示组件中的使用**:

```vue
<!-- Emoji图标 -->
<span 
  v-if="!item.iconType || item.iconType === 'emoji'" 
  class="icon-emoji"
  :style="{ color: item.color }"
>
  {{ item.icon }}
</span>

<!-- SVG图标 -->
<img
  v-else-if="item.iconType === 'svg'"
  :src="item.icon"
  :alt="item.title"
  class="icon-svg"
  :style="{ filter: item.color ? `drop-shadow(0 0 4px ${item.color})` : '' }"
/>

<!-- CSS图标 -->
<i
  v-else-if="item.iconType === 'css'"
  :class="item.icon"
  :style="{ color: item.color }"
></i>

<!-- Lottie动画 -->
<LottieIcon
  v-else-if="item.iconType === 'lottie'"
  :animation-data="item.icon"
  :width="48"
  :height="48"
/>
```

### 已集成图标的模块

| 模块 | 配置组件 | 图标用途 | 支持类型 |
|------|---------|---------|---------|
| 企业简介 | CompanyIntroConfig | 数据亮点图标 | 全部4种 |
| 通用网格 | StandardGridConfig | 网格项图标 | 全部4种 |
| 时间线 | TimelineConfig | 事件标记图标 | 全部4种 |
| 联系方式 | ContactInfoConfig | 联系图标 | Emoji/CSS/SVG |
| 社交链接 | SocialLinksConfig | 社交图标 | SVG |

### 图标 vs 图片的区别

**图标（Icons）** - 装饰性元素:
- ✅ 用途：社交平台标识、联系方式、数据亮点装饰
- ✅ 格式：SVG、Emoji、CSS、Lottie
- ✅ 特点：矢量格式、文件极小（<10KB）、单色或简单色彩
- ❌ 不包含复杂信息

**图片（Images）** - 信息性内容:
- ✅ 用途：企业Logo、产品图片、团队照片、素材库封面
- ✅ 格式：PNG、JPG
- ✅ 特点：位图格式、文件较大（100KB-2MB）、全彩色、承载实际信息
- ❌ 不适合装饰性元素

**禁止混用**:
- ❌ 企业Logo使用图标 → ✅ 上传真实Logo图片
- ❌ 素材库封面使用图标 → ✅ 上传产品/服务图片
- ❌ 社交平台使用图片 → ✅ 使用对应SVG图标

### 添加新图标

#### 添加SVG图标
1. 准备SVG文件（建议24x24或32x32）
2. 放入目录：`/static/icons/`
3. 更新配置：`/config/icon-library.js`
```javascript
{
  name: '新图标',
  file: 'new-icon.svg',
  category: 'general',
  keywords: ['新', 'new', 'icon']
}
```
4. 刷新页面即可使用

#### 添加CSS图标
1. 在 `/assets/css/icon-font.css` 中定义图标类
2. 更新 `/config/icon-library.js` 的 `CSS_ICONS`
```javascript
{ class: 'icon-new', name: '新图标', category: 'action' }
```

#### 添加Emoji
1. 更新 `/config/icon-library.js` 的 `EMOJI_ICONS`
```javascript
{ emoji: '🆕', name: '新', category: 'symbols' }
```

---

## 🎯 套餐限制标准

### 通用限制配置
**位置**: `/config/framework-definitions.js`

```javascript
planLimits: {
  free: {
    max_items: 3,
    max_images: 5,
    max_videos: 0
  },
  trial: {
    max_items: 6,
    max_images: 8,
    max_videos: 1
  },
  pro: {
    max_items: 10,
    max_images: 10,
    max_videos: 1
  },
  enterprise: {
    max_items: 15,
    max_images: 20,
    max_videos: 2
  }
}
```

### 具体模块限制

| 模块 | free | trial | pro | enterprise |
|------|------|-------|-----|-----------|
| **企业简介** |
| 数据亮点 | 3 | 8 | 10 | 15 |
| **通用网格** |
| 网格项 | 4 | 6 | 10 | 15 |
| **多媒体展示** |
| 图片 | 5 | 8 | 10 | 20 |
| 视频 | 0 | 1 | 1 | 2 |
| **Logo墙** |
| Logo数量 | 8 | 20 | 20 | 30 |
| **信任背书** |
| 证书数量 | 4 | 6 | 10 | 15 |
| **时间线** |
| 事件数量 | 4 | 6 | 10 | 15 |

---

## 🛠 关键Mixins

### 1. debounce-mixin.js
**功能**: 性能优化，防抖保存

```javascript
// 防抖延迟
debounceDelay: 500,

// 轻量级数据比较
smartClone(data) {
  // 浅拷贝 + 一级数组深拷贝
}
```

### 2. upload-security-mixin.js
**功能**: 上传安全控制

```javascript
// 频率限制
quickSecurityCheck() {
  // 2秒冷却时间
  // 配额检查
}

// 文件验证
securityCheckBeforeUpload(files) {
  // 类型检查
  // 大小检查（500KB）
  // 数量检查
}
```

### 3. icon-support-mixin.js
**功能**: 图标渲染支持

```javascript
// 支持类型
- Emoji（直接显示）
- SVG（本地文件）
- CSS类（iconfont）
- Lottie（动画）
```

---

## 📦 重要模块详解

### 0. 名片头部模块（CardHeader）

**组件位置**: `components/card/CardHeader.vue`  
**配置组件**: 
- `components/workspace/config/BackgroundEditor.vue`（背景设置）
- `components/workspace/config/AvatarEditor.vue`（头像设置）

**布局结构**:
- 背景层（高度192px，撑满宽度）
- 头像（110px圆形，圆心位于整个头部中心192px，跨越背景区和文字信息区）
- 姓名（18px，主文字颜色）
- 公司简称 - 职务（15px，单行显示）
- Slogan（13px，单独一行，可选）

**背景配置**:
- **SVG图案**: 6种预设模板（几何、圆点、线条、波浪、网格、圆圈），支持渐变和透明度
- **图片上传**: 支持自定义图片背景，可调整透明度、模糊度、饱和度
- **纯色**: 支持纯色背景

**头像配置**:
- 默认使用企业微信头像
- 支持上传高清自定义头像
- 头像无时显示姓名首字母占位符

**样式特点**:
- 撑满宽度，无左右边距
- 底部圆角20px（移动端16px）
- 底部阴影增强层次感
- 头像与姓名间距80px
- 与其他模块底部间距12px

**按钮功能**:
- "保存到通讯录"和"分享"按钮已集成到名片底部操作区（`contact-actions-footer`）
- 按钮样式：100px × 36px，2px黑色边框，11px大写文字

**数据结构**:
```javascript
{
  header: {
    background: {
      backgroundType: 'svg',  // 'svg' | 'image' | 'solid'
      svgPattern: 'geometric',  // SVG图案类型
      svgGradientStart: '#ffffff',
      svgGradientEnd: '#FC726E',
      svgOpacity: 0.5,
      backgroundImage: '',  // 图片URL
      imageOpacity: 0.8,
      imageBlur: 0,
      imageSaturation: 1.2,
      solidColor: '#667eea'
    }
  },
  avatar: {
    useWecomAvatar: true,  // 是否使用企业微信头像
    customAvatar: '',      // 自定义头像URL
    wecomAvatar: ''       // 企业微信头像URL
  }
}
```

### 1. 多媒体展示模块（VideoShowcase）

**支持模式**:
- `video`: 视频展示（1-2个视频）
- `text-image-alt`: 图文交替（文字块 + 固定高度图片）
- `image-grid`: 单行横滑图片廊（保持2/3列配置，自动横向滑动）

**最新特性**:
- 图文模式的段落统一为 **14px / 行高1.4 / 段间距6px**，阅读更紧凑。
- 图文模式的图片展示区域固定为 **240px**（≤768px 为 200px，≤480px 为 180px），使用 `object-fit: cover` 适配 **16:9 / 5:3** 素材。
- 图片块新增 **点击放大** 功能：Hover 提示“点击放大”，点击后进入遮罩预览，支持 ESC/点击空白关闭。
- `image-grid` 模式改为 **单行横滑**，自动按列配置计算卡片宽度，可在移动端左右滑动查看；底部保留 16px 呼吸感，避免与其它模块贴合。

### 2. 企业简介模块（CompanyIntro）

**支持布局**:
- 顶部图片 + 文字内容
- 左/右浮动图片 + 文字环绕
- 数据亮点（渐变背景）

**特点**:
- 顶部图片呼吸感设计
- 文字折叠展开
- 数据亮点可配置图标
- 数据亮点列数在移动端不再被强制降级，**选择3列即全断点保持3列**，适用于高密度指标对比。

### 3. 通用网格模块（StandardGrid）

**支持模式**:
- `icon`: 图标 + 文字
- `image`: 图片 + 文字
- `logo`: 纯Logo展示
- `text`: 纯文字卡片

**特点**:
- 1/2/3列自适应
- 悬停上浮效果
- 点击查看详情（图片模式）
- 移动端尊重列数配置（不再无条件降为单列），可在设置时按实际内容密度选择 1/2/3 列。

### 4. 信任背书模块（TrustCredentials）

**视觉增强**:
- 半透明背景层
- 彩色模糊光斑动画
- 图片圆角12px
- 悬停放大效果

---

## 🚀 性能优化

### 前端优化
- ✅ 图片自动压缩（1200px宽，质量0.75）
- ✅ 防抖处理（500ms延迟）
- ✅ 上传频率限制（2秒冷却）
- ✅ 懒加载（列表分页）

### 图片处理标准
```javascript
// 压缩配置
{
  quality: 0.75,
  maxWidth: 1200,
  maxHeight: 1200,
  mimeType: 'image/jpeg'
}

// 大小限制
maxSize: 500 * 1024  // 500KB
```

---

## 🔐 安全规范

### 上传安全
- ✅ 文件类型白名单（jpg/jpeg/png/gif/webp）
- ✅ 文件大小限制（500KB）
- ✅ 上传频率限制（2秒冷却）
- ✅ 配额限制（按套餐）

### 数据隔离
- ✅ tenant_id强制过滤
- ✅ JWT token验证
- ✅ 外键约束

---

## 📝 开发规范

### 组件命名
- 展示组件: `XxxModule.vue` (如 `CompanyIntro.vue`)
- 配置组件: `XxxModuleConfig.vue` (如 `CompanyIntroConfig.vue`)

### 数据结构
```javascript
// 模块配置数据
{
  title: '',           // 标题
  subtitle: '',        // 副标题
  mode: '',            // 显示模式
  items: [],           // 数据项
  // ... 其他字段
}
```

### 事件命名
```javascript
// 配置组件向父组件传递
this.$emit('update:data', newData)

// 使用 .sync 修饰符
<XxxConfig :data.sync="moduleData" />
```

---

## 🐛 常见问题

**Q: 模块预览不更新?**  
A: 检查是否使用了 `v-model` 而非 `.sync`

**Q: 图片显示blob:?**  
A: 使用 `/api/v1/files/upload` 上传获取稳定URL

**Q: 保存后崩溃?**  
A: 检查 `debounce-mixin` 是否正确混入

**Q: 样式不一致?**  
A: 参考本文档CSS标准统一样式

---

## 📁 关键文件索引

### 前端组件
```
components/
├── card/                    # 展示组件
│   ├── WecardOptimized.vue
│   ├── CardHeader.vue       # 名片头部
│   ├── StandardGrid.vue
│   ├── VideoShowcase.vue
│   ├── CompanyIntro.vue
│   ├── TrustCredentials.vue
│   ├── LogoWall.vue
│   └── Timeline.vue
│
└── workspace/               # 配置组件
    ├── config/
    │   ├── BackgroundEditor.vue    # 头部背景配置
    │   ├── AvatarEditor.vue         # 头像配置
    │   ├── StandardGridConfig.vue
    │   ├── VideoShowcaseConfig.vue
    │   ├── CompanyIntroConfig.vue
    │   └── ...Config.vue
    └── AssetsLibrary.vue    # 素材库
```

### 配置文件
```
config/
├── framework-definitions.js    # 模块定义
└── upload-limits.js           # 上传限制
```

### Mixins
```
components/workspace/config/
├── debounce-mixin.js          # 防抖
├── upload-security-mixin.js   # 上传安全
└── icon-support-mixin.js      # 图标支持
```

---

## 📊 更新日志

### v2.11 (2024-11-18)
- ✅ **成员管理界面优化**：8列紧凑设计，解决姓名列过长和ID识别问题
  - 移除独立ID列，整合到姓名下方（显示后6位 + 数据来源徽章）
  - 优化列宽分配：头像70px、推送照片80px、姓名160px等
  - 新增数据来源列：直观显示OAuth授权/通讯录同步状态
  - 姓名显示优先级：display_name > name（非加密ID）> "未设置"
- ✅ **推送头像配置说明**：明确全局配置 vs 单点覆盖的设计理念
  - 推送设置中的companyAvatar：全租户统一（如公司Logo）
  - 成员管理中的custom_push_photo_url：单人专属（如销售个人照）
  - 优先级：单人设置 > 全局配置 > 企微头像
- ✅ **OAuth授权局限说明**：文档化企微API对第三方应用的限制

### v2.10 (2025-01-XX)
- ✅ **名片头部模块重构**：居中头像设计，支持SVG图案/图片/纯色三种背景
- ✅ **素材库链接统一**：修复链接格式，使用锚点定位单个素材
- ✅ **网店直达模块**：支持电商平台APP唤醒和小程序唤醒
- ✅ **模块排序优化**：支持多个同类型模块

### v2.7 (2025-11-06)
- ✅ **统一文字格式规范**：标题16px、副标题14px、正文14px、说明12px
- ✅ **统一图片圆角标准**：所有模块图片统一使用12px圆角
- ✅ **统一段落间距规范**：正文段落间距12px，内容块间距16px
- ✅ **更新模块样式**：素材库、VideoShowcase、Timeline、TrustCredentials已统一
- ✅ **特殊格式说明**：Timeline事件描述使用13px/1.4行高

### v2.6 (2025-11-05)
- ✅ 新增图标系统完整说明
- ✅ 300+图标资源管理
- ✅ IconPicker组件使用规范
- ✅ 图标vs图片区分标准

### v2.5 (2025-11-05)
- ✅ 统一CSS设计标准
- ✅ 明确颜色/圆角/间距规范
- ✅ 补充套餐限制说明
- ✅ 添加模块详解

### v2.4 (2025-11-04)
- ✅ 多媒体展示模块
- ✅ 信任背书视觉增强
- ✅ 企业简介呼吸感设计

---

**维护团队**: WeCard开发组  
**技术支持**: 企业微信工作台环境优化  
**最后验证**: 2024-11-18 ✅
