## 检查摘要

- **企微 OAuth 与权限分流**：`workspace.vue` 在 OAuth 成功后校验 `is_admin`，普通成员自动重定向到 `/wecom/card`，与《企微应用配置-管理员与普通用户分离.md》一致。
- **管理员工作台预览**：`PreviewPanel.vue` 调用 `WecardOptimized` 时固定 `:show-share-panel="false"`，确保后台视图没有分享面板，符合文档要求。
- **工作台配置接口**：`/api/v1/wecom/tenant/workspace` 已输出新版 `workspace` JSON；但系统仍保留旧的 `card_template` 结构，两套配置并存需后续统一。
- **普通用户名片接口问题**：`get_my_card` 仍引用 `member.avatar`、`member.wechat` 等字段，与 `Member` 模型定义不符，线上会触发 `AttributeError` 并导致接口 500，必须修复。

## 修复建议

1. **修正名片字段引用**
   - 在 `get_my_card` 中把头像字段改用 `member.avatar_url`，缺失微信字段时从配置或同步信息中补充。
   - 如需长期使用微信账号，建议在 `Member` 模型中新增 `wechat` 字段并完善同步流程。

2. **合并配置结构**
   - 明确 `workspace` 与 `card_template` 的关系：选择其一作为权威数据，并在另一个接口中做兼容映射，避免同一租户写入两份模版。
   - 文档同步更新，标注哪些模块已切换到 `workspace` 管理，哪些仍依赖旧配置。

3. **强化差异文档**
   - 在 docs 中注明尚未实现或仍在规划的模块（如素材库、统计），防止阅读旧文档时误判为已上线功能。

## 后续验证

- 回归测试 `/wecom/card`，确保普通用户和管理员都能成功加载名片，不再因字段缺失抛错。
- 测试管理员保存工作台配置后，普通用户名片是否同步显示（验证配置统一方案已生效）。


可以从几条“企微 WebView ↓ 网络端”链路入手做性能优化，优先处理影响最大的几点：
前端构建模式：现在线上跑的是 npm run dev:light（开发模式）——SSR、HMR、未压缩的 bundle 都会拖慢初次加载。建议在正式环境改为 nuxt build && NODE_ENV=production nuxt start（或 npm run build && npm run start:compact）以启用 Tree-shaking、代码压缩、缓存分块。开发模式仅在调试时使用。
静态资源与 CDN：企微 WebView 对跨域静态资源也有严格限制。把公共 JS/CSS、图片上传到同域（https://zjemail.cn）并开启 gzip / brotli 压缩，或使用企微允许的自建 CDN，加上合理的 Cache-Control，可减少二次打开耗时。
首屏数据与模块裁剪：确认 /api/v1/wecom/card/my 返回的数据是否只包含当前页面所需；对大块模块（VideoShowcase 的图片数组、素材列表等）可以启用按需加载或懒加载，避免一次请求塞入大量 JSON。也可以在 Nuxt 里开启 nuxt.config.js -> render.bundleRenderer.shouldPreload 针对首屏关键资源。
图片/视频优化：虽然文档已有 1200px/500KB 限制，但 VideoShowcase、横滑图片廊等组件仍可能加载多张高质量图。考虑在接口中提供多尺寸 URL（缩略图 + 原图），在首屏仅加载缩略图，用户点击后再请求原图。
企微网络环境：企业微信客户端通常走公司内网或被代理，DNS/TLS 握手都会拖慢；可以在 Nginx 上启用 HTTP/2、Session Resumption、OCSP Stapling，减轻握手成本。
监控与分析：建议启用前端性能监控（Performance API、埋点）记录 TTFB、DOMContentLoaded、First Interaction 等指标，以便定位“慢”的具体阶段（DNS、API、渲染、图片、JS）。
执行顺序建议：先切换到生产构建 → 启用 gzip/http2 → 优化首屏数据 → 精简图片，再根据监控结果做更细的缓存和懒加载调优。